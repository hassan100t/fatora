<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù…ØªØ¬Ø± Ø§Ù„Ø¹Ø±Ø§Ù‚ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@200;300;400;500;700;800;900&display=swap" rel="stylesheet">
  <style>
    /* Reset and Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Tajawal', Arial, sans-serif;
      direction: rtl;
      background-color: #f8fafc;
      color: #1e293b;
      line-height: 1.6;
    }

    /* Header */
    .header {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(8px);
      border-bottom: 1px solid #e2e8f0;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: #2563eb;
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-name {
      color: #64748b;
      font-weight: 500;
    }

    .auth-btn {
      background: #2563eb;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      cursor: pointer;
      font-weight: 500;
      transition: background-color 0.2s;
    }

    .auth-btn:hover {
      background: #1d4ed8;
    }

    /* Main Content */
    .main-content {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    /* Login Section */
    .login-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 3rem;
      min-height: 60vh;
      justify-content: center;
    }

    .welcome-content {
      text-align: center;
    }

    .welcome-title {
      font-size: 2.5rem;
      font-weight: 700;
      color: #2563eb;
      margin-bottom: 1rem;
    }

    .welcome-subtitle {
      font-size: 1.25rem;
      color: #64748b;
      max-width: 600px;
    }

    .login-form-container {
      width: 100%;
      max-width: 400px;
    }

    .login-form {
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      border: 1px solid #e2e8f0;
    }

    .login-form h3 {
      text-align: center;
      margin-bottom: 1.5rem;
      color: #1e293b;
      font-size: 1.5rem;
    }

    .login-form input {
      width: 100%;
      padding: 0.75rem;
      margin-bottom: 1rem;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    .login-form input:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .login-form button {
      width: 100%;
      background: #2563eb;
      color: white;
      border: none;
      padding: 0.75rem;
      border-radius: 0.5rem;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .login-form button:hover {
      background: #1d4ed8;
    }

    /* App Content */
    .app-content {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    /* Navigation Tabs */
    .nav-tabs {
      background: white;
      border-radius: 1rem;
      padding: 1rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      border: 1px solid #e2e8f0;
      display: flex;
      gap: 1rem;
      overflow-x: auto;
    }

    .nav-tab {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      border: none;
      border-radius: 0.5rem;
      background: #f1f5f9;
      color: #64748b;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
      position: relative;
    }

    .nav-tab:hover {
      background: #e2e8f0;
      color: #475569;
    }

    .nav-tab.active {
      background: #2563eb;
      color: white;
    }

    .cart-count {
      background: #ef4444;
      color: white;
      border-radius: 50%;
      width: 1.5rem;
      height: 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 600;
      position: absolute;
      top: -0.25rem;
      left: -0.25rem;
    }

    /* Tab Content */
    .tab-content {
      background: white;
      border-radius: 1rem;
      padding: 2rem;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      border: 1px solid #e2e8f0;
    }

    .tab-pane {
      display: none;
    }

    .tab-pane.active {
      display: block;
    }

    /* Products */
    .products-header {
      margin-bottom: 2rem;
    }

    .search-filters {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .search-input, .filter-select {
      padding: 0.5rem;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      font-size: 1rem;
    }

    .search-input {
      flex: 1;
      min-width: 200px;
    }

    .products-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 1.5rem;
    }

    .product-card {
      border: 1px solid #e2e8f0;
      border-radius: 1rem;
      overflow: hidden;
      transition: all 0.2s;
      background: white;
    }

    .product-card:hover {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transform: translateY(-2px);
    }

    .product-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      background: #f1f5f9;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #94a3b8;
      font-size: 3rem;
    }

    .product-info {
      padding: 1rem;
    }

    .product-name {
      font-size: 1.125rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: #1e293b;
    }

    .product-description {
      color: #64748b;
      font-size: 0.875rem;
      margin-bottom: 1rem;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .product-details {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .product-price {
      font-size: 1.25rem;
      font-weight: 700;
      color: #2563eb;
    }

    .product-stock {
      font-size: 0.875rem;
      color: #64748b;
    }

    .add-to-cart {
      width: 100%;
      background: #2563eb;
      color: white;
      border: none;
      padding: 0.75rem;
      border-radius: 0.5rem;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .add-to-cart:hover:not(:disabled) {
      background: #1d4ed8;
    }

    .add-to-cart:disabled {
      background: #94a3b8;
      cursor: not-allowed;
    }

    /* Cart */
    .cart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .cart-actions {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .cart-items {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .cart-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      background: #fafafa;
    }

    .cart-item-image {
      width: 60px;
      height: 60px;
      object-fit: cover;
      border-radius: 0.5rem;
      background: #f1f5f9;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #94a3b8;
      font-size: 1.5rem;
    }

    .cart-item-info {
      flex: 1;
    }

    .cart-item-name {
      font-weight: 600;
      margin-bottom: 0.25rem;
    }

    .cart-item-description {
      font-size: 0.875rem;
      color: #64748b;
      margin-bottom: 0.25rem;
    }

    .cart-item-price {
      color: #2563eb;
      font-weight: 600;
    }

    .quantity-controls {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .quantity-btn {
      width: 2rem;
      height: 2rem;
      border: none;
      border-radius: 50%;
      background: #e2e8f0;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      transition: background-color 0.2s;
    }

    .quantity-btn:hover {
      background: #cbd5e1;
    }

    .quantity-display {
      min-width: 3rem;
      text-align: center;
      font-weight: 600;
    }

    .cart-item-actions {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 0.5rem;
    }

    .cart-item-total {
      font-weight: 600;
      color: #1e293b;
    }

    .remove-item {
      color: #ef4444;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 0.875rem;
      text-decoration: underline;
    }

    .cart-total {
      border-top: 2px solid #e2e8f0;
      padding-top: 1rem;
    }

    .total-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      font-size: 1.25rem;
      font-weight: 600;
    }

    .checkout-btn {
      width: 100%;
      background: #2563eb;
      color: white;
      border: none;
      padding: 1rem;
      border-radius: 0.5rem;
      font-size: 1.125rem;
      font-weight: 600;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .checkout-btn:hover {
      background: #1d4ed8;
    }

    /* Profile */
    .profile-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .profile-form {
      max-width: 600px;
      margin: 0 auto;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .form-group label {
      font-weight: 600;
      color: #374151;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      padding: 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .form-group input:disabled,
    .form-group textarea:disabled,
    .form-group select:disabled {
      background: #f9fafb;
      color: #6b7280;
    }

    /* Orders */
    .orders-list {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .order-card {
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      padding: 1.5rem;
      background: white;
    }

    .order-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
    }

    .order-info h3 {
      font-size: 1.125rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }

    .order-date {
      color: #64748b;
      font-size: 0.875rem;
    }

    .order-status {
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 500;
    }

    .status-pending {
      background: #fef3c7;
      color: #92400e;
    }

    .status-confirmed {
      background: #dbeafe;
      color: #1e40af;
    }

    .status-shipped {
      background: #e0e7ff;
      color: #5b21b6;
    }

    .status-delivered {
      background: #d1fae5;
      color: #065f46;
    }

    .status-cancelled {
      background: #fee2e2;
      color: #991b1b;
    }

    .order-items {
      margin-bottom: 1rem;
    }

    .order-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid #f3f4f6;
    }

    .order-item:last-child {
      border-bottom: none;
    }

    .order-total {
      border-top: 2px solid #e2e8f0;
      padding-top: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 600;
      font-size: 1.125rem;
    }

    /* Admin */
    .admin-nav {
      display: flex;
      gap: 1rem;
      margin-bottom: 2rem;
      border-bottom: 1px solid #e2e8f0;
    }

    .admin-nav-btn {
      padding: 0.75rem 1rem;
      border: none;
      background: none;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all 0.2s;
      font-weight: 500;
    }

    .admin-nav-btn:hover {
      color: #2563eb;
    }

    .admin-nav-btn.active {
      color: #2563eb;
      border-bottom-color: #2563eb;
    }

    .admin-section {
      display: none;
    }

    .admin-section.active {
      display: block;
    }

    .admin-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .admin-form {
      background: #f8fafc;
      padding: 1.5rem;
      border-radius: 0.5rem;
      border: 1px solid #e2e8f0;
      margin-bottom: 2rem;
    }

    .admin-form h4 {
      margin-bottom: 1rem;
      font-size: 1.125rem;
      font-weight: 600;
    }

    .admin-form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .admin-form-actions {
      display: flex;
      gap: 1rem;
    }

    .admin-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1rem;
    }

    .admin-card {
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      padding: 1rem;
      background: white;
    }

    .admin-card h4 {
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .admin-card p {
      color: #64748b;
      font-size: 0.875rem;
      margin-bottom: 0.5rem;
    }

    /* Buttons */
    .btn-primary {
      background: #2563eb;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      cursor: pointer;
      font-weight: 500;
      transition: background-color 0.2s;
    }

    .btn-primary:hover {
      background: #1d4ed8;
    }

    .btn-danger {
      background: #ef4444;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      cursor: pointer;
      font-weight: 500;
      transition: background-color 0.2s;
    }

    .btn-danger:hover {
      background: #dc2626;
    }

    .btn-secondary {
      background: #6b7280;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      cursor: pointer;
      font-weight: 500;
      transition: background-color 0.2s;
    }

    .btn-secondary:hover {
      background: #4b5563;
    }

    /* Utilities */
    .hidden {
      display: none !important;
    }

    .empty-state {
      text-align: center;
      padding: 3rem;
      color: #64748b;
    }

    .empty-state-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
      color: #374151;
    }

    /* Toast Notifications */
    .toast-container {
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 1000;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .toast {
      background: white;
      border: 1px solid #e2e8f0;
      border-radius: 0.5rem;
      padding: 1rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      min-width: 300px;
      animation: slideIn 0.3s ease-out;
    }

    .toast.success {
      border-left: 4px solid #10b981;
    }

    .toast.error {
      border-left: 4px solid #ef4444;
    }

    @keyframes slideIn {
      from {
        transform: translateX(-100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header {
        padding: 1rem;
      }

      .main-content {
        padding: 1rem;
      }

      .welcome-title {
        font-size: 2rem;
      }

      .welcome-subtitle {
        font-size: 1rem;
      }

      .search-filters {
        flex-direction: column;
      }

      .cart-header {
        flex-direction: column;
        align-items: stretch;
      }

      .cart-item {
        flex-direction: column;
        align-items: stretch;
        gap: 1rem;
      }

      .cart-item-actions {
        flex-direction: row;
        justify-content: space-between;
        align-items: center;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }

      .admin-form-grid {
        grid-template-columns: 1fr;
      }

      .admin-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <h2 class="header-title">Ù…ØªØ¬Ø± Ø§Ù„Ø¹Ø±Ø§Ù‚ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</h2>
    <div class="header-actions">
      <span id="user-name" class="user-name">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø²Ø§Ø¦Ø±</span>
      <button id="auth-btn" class="auth-btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Login Section (Initially visible) -->
    <div id="login-section" class="login-section">
      <div class="welcome-content">
        <h1 class="welcome-title">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ…</h1>
        <p class="welcome-subtitle">Ø§Ù„Ù„Ù‡Ù… ØµÙ„ Ø¹Ù„Ù‰ Ù…Ø­Ù…Ø¯ ÙˆØ§Ù„ Ù…Ø­Ù…Ø¯</p>
      </div>
      
      <div class="login-form-container">
        <form id="login-form" class="login-form">
          <h3>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h3>
          <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" required>
          <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" required>
          <button type="submit">Ø¯Ø®ÙˆÙ„</button>
        </form>
      </div>
    </div>

    <!-- App Content (Initially hidden) -->
    <div id="app-content" class="app-content hidden">
      <!-- Navigation -->
      <nav class="nav-tabs">
        <button class="nav-tab active" data-tab="products">
          <span>ğŸ›ï¸</span>
          <span>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
        </button>
        <button class="nav-tab" data-tab="cart">
          <span>ğŸ›’</span>
          <span>Ø§Ù„Ø³Ù„Ø©</span>
          <span id="cart-count" class="cart-count hidden">0</span>
        </button>
        <button class="nav-tab" data-tab="profile">
          <span>ğŸ‘¤</span>
          <span>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</span>
        </button>
        <button class="nav-tab" data-tab="orders">
          <span>ğŸ“¦</span>
          <span>Ø·Ù„Ø¨Ø§ØªÙŠ</span>
        </button>
        <button class="nav-tab" data-tab="admin">
          <span>âš™ï¸</span>
          <span>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</span>
        </button>
      </nav>

      <!-- Tab Content -->
      <div class="tab-content">
        <!-- Products Tab -->
        <div id="products-tab" class="tab-pane active">
          <div class="products-header">
            <div class="search-filters">
              <input type="text" id="search-input" placeholder="Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª..." class="search-input">
              <select id="category-filter" class="filter-select">
                <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>
              </select>
              <select id="currency-select" class="filter-select">
                <option value="IQD">Ø¯ÙŠÙ†Ø§Ø± Ø¹Ø±Ø§Ù‚ÙŠ</option>
                <option value="USD">Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ</option>
              </select>
            </div>
          </div>
          <div id="products-grid" class="products-grid">
            <!-- Products will be loaded here -->
          </div>
        </div>

        <!-- Cart Tab -->
        <div id="cart-tab" class="tab-pane">
          <div class="cart-header">
            <h2>Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h2>
            <div class="cart-actions">
              <select id="cart-currency" class="filter-select">
                <option value="IQD">Ø¯ÙŠÙ†Ø§Ø± Ø¹Ø±Ø§Ù‚ÙŠ</option>
                <option value="USD">Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ</option>
              </select>
              <button id="clear-cart" class="btn-danger">Ù…Ø³Ø­ Ø§Ù„Ø³Ù„Ø©</button>
            </div>
          </div>
          <div id="cart-items" class="cart-items">
            <!-- Cart items will be loaded here -->
          </div>
          <div id="cart-total" class="cart-total">
            <div class="total-row">
              <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
              <span id="total-amount">0 Ø¯.Ø¹</span>
            </div>
            <button id="checkout-btn" class="checkout-btn">Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨</button>
          </div>
        </div>

        <!-- Profile Tab -->
        <div id="profile-tab" class="tab-pane">
          <div class="profile-header">
            <h2>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</h2>
            <button id="edit-profile" class="btn-primary">ØªØ¹Ø¯ÙŠÙ„</button>
          </div>
          <form id="profile-form" class="profile-form">
            <div class="form-grid">
              <div class="form-group">
                <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„</label>
                <input type="text" id="profile-name" disabled>
              </div>
              <div class="form-group">
                <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                <input type="email" id="profile-email" disabled>
              </div>
              <div class="form-group">
                <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
                <input type="tel" id="profile-phone" disabled>
              </div>
              <div class="form-group">
                <label>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</label>
                <input type="text" id="profile-city" disabled>
              </div>
            </div>
            <div class="form-group">
              <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
              <textarea id="profile-address" disabled rows="3"></textarea>
            </div>
            <div class="form-group">
              <label>Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…ÙØ¶Ù„Ø©</label>
              <select id="profile-currency" disabled>
                <option value="IQD">Ø¯ÙŠÙ†Ø§Ø± Ø¹Ø±Ø§Ù‚ÙŠ</option>
                <option value="USD">Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ</option>
              </select>
            </div>
            <button type="submit" id="save-profile" class="btn-primary hidden">Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª</button>
          </form>
        </div>

        <!-- Orders Tab -->
        <div id="orders-tab" class="tab-pane">
          <h2>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
          <div id="orders-list" class="orders-list">
            <!-- Orders will be loaded here -->
          </div>
        </div>

        <!-- Admin Tab -->
        <div id="admin-tab" class="tab-pane">
          <h2>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h2>
          <div class="admin-nav">
            <button class="admin-nav-btn active" data-section="products">Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
            <button class="admin-nav-btn" data-section="orders">Ø§Ù„Ø·Ù„Ø¨Ø§Øª</button>
            <button class="admin-nav-btn" data-section="categories">Ø§Ù„ÙØ¦Ø§Øª</button>
          </div>
          
          <div id="admin-content">
            <!-- Products Admin -->
            <div id="admin-products" class="admin-section active">
              <div class="admin-header">
                <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h3>
                <button id="show-add-product" class="btn-primary">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</button>
              </div>
              
              <div id="add-product-form" class="admin-form hidden">
                <h4>Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h4>
                <form id="product-form">
                  <div class="admin-form-grid">
                    <input type="text" id="product-name" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" required>
                    <select id="product-category" required>
                      <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø©</option>
                    </select>
                    <input type="number" id="product-price-iqd" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ø¯ÙŠÙ†Ø§Ø± Ø§Ù„Ø¹Ø±Ø§Ù‚ÙŠ" required>
                    <input type="number" step="0.01" id="product-price-usd" placeholder="Ø§Ù„Ø³Ø¹Ø± Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±" required>
                    <input type="number" id="product-stock" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªÙˆÙØ±Ø©" required>
                    <input type="url" id="product-image" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
                  </div>
                  <div class="form-group">
                    <textarea id="product-description" placeholder="ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬" required rows="3"></textarea>
                  </div>
                  <div class="admin-form-actions">
                    <button type="submit" class="btn-primary">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</button>
                    <button type="button" id="cancel-add-product" class="btn-secondary">Ø¥Ù„ØºØ§Ø¡</button>
                  </div>
                </form>
              </div>
              
              <div id="admin-products-grid" class="admin-grid">
                <!-- Admin products will be loaded here -->
              </div>
            </div>

            <!-- Orders Admin -->
            <div id="admin-orders" class="admin-section">
              <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
              <div id="admin-orders-list" class="orders-list">
                <!-- Admin orders will be loaded here -->
              </div>
            </div>

            <!-- Categories Admin -->
            <div id="admin-categories" class="admin-section">
              <div class="admin-header">
                <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙØ¦Ø§Øª</h3>
                <button id="show-add-category" class="btn-primary">Ø¥Ø¶Ø§ÙØ© ÙØ¦Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
              </div>
              
              <div id="add-category-form" class="admin-form hidden">
                <h4>Ø¥Ø¶Ø§ÙØ© ÙØ¦Ø© Ø¬Ø¯ÙŠØ¯Ø©</h4>
                <form id="category-form">
                  <div class="form-group">
                    <input type="text" id="category-name" placeholder="Ø§Ø³Ù… Ø§Ù„ÙØ¦Ø©" required>
                  </div>
                  <div class="form-group">
                    <textarea id="category-description" placeholder="ÙˆØµÙ Ø§Ù„ÙØ¦Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" rows="3"></textarea>
                  </div>
                  <div class="admin-form-actions">
                    <button type="submit" class="btn-primary">Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ¦Ø©</button>
                    <button type="button" id="cancel-add-category" class="btn-secondary">Ø¥Ù„ØºØ§Ø¡</button>
                  </div>
                </form>
              </div>
              
              <div id="admin-categories-grid" class="admin-grid">
                <!-- Admin categories will be loaded here -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Toast Notifications -->
  <div id="toast-container" class="toast-container"></div>

  <script>
    // Data Storage
    let currentUser = null;
    let currentCurrency = 'IQD';
    let cart = [];
    let orders = [];
    let isEditingProfile = false;

    // Sample Data
    const categories = [
      { id: 1, name: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª', description: 'Ø£Ø¬Ù‡Ø²Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù…ØªÙ†ÙˆØ¹Ø©', isActive: true },
      { id: 2, name: 'Ù…Ù„Ø§Ø¨Ø³', description: 'Ù…Ù„Ø§Ø¨Ø³ Ø±Ø¬Ø§Ù„ÙŠØ© ÙˆÙ†Ø³Ø§Ø¦ÙŠØ©', isActive: true },
      { id: 3, name: 'ÙƒØªØ¨', description: 'ÙƒØªØ¨ ÙˆÙ…Ø±Ø§Ø¬Ø¹ Ù…ØªÙ†ÙˆØ¹Ø©', isActive: true },
      { id: 4, name: 'Ù…Ù†Ø²Ù„ ÙˆÙ…Ø·Ø¨Ø®', description: 'Ø£Ø¯ÙˆØ§Øª Ù…Ù†Ø²Ù„ÙŠØ© ÙˆÙ…Ø·Ø¨Ø®ÙŠØ©', isActive: true }
    ];

    const products = [
      {
        id: 1,
        name: 'Ù‡Ø§ØªÙ Ø°ÙƒÙŠ Ø³Ø§Ù…Ø³ÙˆÙ†Ø¬',
        description: 'Ù‡Ø§ØªÙ Ø°ÙƒÙŠ Ø¨Ù…ÙˆØ§ØµÙØ§Øª Ø¹Ø§Ù„ÙŠØ© ÙˆÙƒØ§Ù…ÙŠØ±Ø§ Ù…Ù…ØªØ§Ø²Ø©',
        priceIQD: 750000,
        priceUSD: 500,
        category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª',
        stock: 15,
        imageUrl: '',
        isActive: true
      },
      {
        id: 2,
        name: 'Ù‚Ù…ÙŠØµ Ù‚Ø·Ù†ÙŠ Ø±Ø¬Ø§Ù„ÙŠ',
        description: 'Ù‚Ù…ÙŠØµ Ù‚Ø·Ù†ÙŠ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© ÙˆÙ…Ø±ÙŠØ­ Ù„Ù„Ø§Ø±ØªØ¯Ø§Ø¡',
        priceIQD: 45000,
        priceUSD: 30,
        category: 'Ù…Ù„Ø§Ø¨Ø³',
        stock: 25,
        imageUrl: '',
        isActive: true
      },
      {
        id: 3,
        name: 'ÙƒØªØ§Ø¨ ØªØ¹Ù„Ù… Ø§Ù„Ø¨Ø±Ù…Ø¬Ø©',
        description: 'ÙƒØªØ§Ø¨ Ø´Ø§Ù…Ù„ Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ù„Ù„Ù…Ø¨ØªØ¯Ø¦ÙŠÙ†',
        priceIQD: 30000,
        priceUSD: 20,
        category: 'ÙƒØªØ¨',
        stock: 10,
        imageUrl: '',
        isActive: true
      },
      {
        id: 4,
        name: 'Ù…Ù‚Ù„Ø§Ø© ØºÙŠØ± Ù„Ø§ØµÙ‚Ø©',
        description: 'Ù…Ù‚Ù„Ø§Ø© Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø© ØºÙŠØ± Ù„Ø§ØµÙ‚Ø© ÙˆØ³Ù‡Ù„Ø© Ø§Ù„ØªÙ†Ø¸ÙŠÙ',
        priceIQD: 60000,
        priceUSD: 40,
        category: 'Ù…Ù†Ø²Ù„ ÙˆÙ…Ø·Ø¨Ø®',
        stock: 20,
        imageUrl: '',
        isActive: true
      },
      {
        id: 5,
        name: 'Ù„Ø§Ø¨ØªÙˆØ¨ Ø¯ÙŠÙ„',
        description: 'Ù„Ø§Ø¨ØªÙˆØ¨ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¯Ø§Ø¡ Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ø¹Ù…Ù„ ÙˆØ§Ù„Ø¯Ø±Ø§Ø³Ø©',
        priceIQD: 1200000,
        priceUSD: 800,
        category: 'Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª',
        stock: 8,
        imageUrl: '',
        isActive: true
      },
      {
        id: 6,
        name: 'ÙØ³ØªØ§Ù† Ù†Ø³Ø§Ø¦ÙŠ Ø£Ù†ÙŠÙ‚',
        description: 'ÙØ³ØªØ§Ù† Ù†Ø³Ø§Ø¦ÙŠ Ø£Ù†ÙŠÙ‚ ÙˆÙ…Ù†Ø§Ø³Ø¨ Ù„Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª',
        priceIQD: 90000,
        priceUSD: 60,
        category: 'Ù…Ù„Ø§Ø¨Ø³',
        stock: 12,
        imageUrl: '',
        isActive: true
      }
    ];

    const users = [
      {
        id: 1,
        username: 'admin',
        password: 'admin123',
        name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯',
        email: 'admin@example.com',
        phone: '07901234567',
        address: 'Ø´Ø§Ø±Ø¹ Ø§Ù„Ø±Ø´ÙŠØ¯ØŒ Ø¨ØºØ¯Ø§Ø¯',
        city: 'Ø¨ØºØ¯Ø§Ø¯',
        preferredCurrency: 'IQD',
        isAdmin: true
      },
      {
        id: 2,
        username: 'user',
        password: 'user123',
        name: 'ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ',
        email: 'user@example.com',
        phone: '07801234567',
        address: 'Ø­ÙŠ Ø§Ù„Ø¬Ø§Ù…Ø¹Ø©ØŒ Ø¨ØºØ¯Ø§Ø¯',
        city: 'Ø¨ØºØ¯Ø§Ø¯',
        preferredCurrency: 'IQD',
        isAdmin: false
      }
    ];

    // Utility Functions
    function formatPrice(priceIQD, priceUSD, currency = currentCurrency) {
      if (currency === 'IQD') {
        return `${priceIQD.toLocaleString()} Ø¯.Ø¹`;
      } else {
        return `$${priceUSD.toFixed(2)}`;
      }
    }

    function showToast(message, type = 'success') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      
      const container = document.getElementById('toast-container');
      container.appendChild(toast);
      
      setTimeout(() => {
        toast.remove();
      }, 3000);
    }

    function updateCartCount() {
      const cartCount = document.getElementById('cart-count');
      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      
      if (totalItems > 0) {
        cartCount.textContent = totalItems;
        cartCount.classList.remove('hidden');
      } else {
        cartCount.classList.add('hidden');
      }
    }

    function getProductById(id) {
      return products.find(p => p.id === id);
    }

    function getCategoryById(id) {
      return categories.find(c => c.id === id);
    }

    // Authentication
    function login(username, password) {
      const user = users.find(u => u.username === username && u.password === password);
      if (user) {
        currentUser = user;
        currentCurrency = user.preferredCurrency;
        
        document.getElementById('user-name').textContent = `Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${user.name}`;
        document.getElementById('auth-btn').textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬';
        
        document.getElementById('login-section').classList.add('hidden');
        document.getElementById('app-content').classList.remove('hidden');
        
        loadProfile();
        loadProducts();
        loadCategories();
        updateCartCount();
        
        showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­');
        return true;
      }
      return false;
    }

    function logout() {
      currentUser = null;
      cart = [];
      
      document.getElementById('user-name').textContent = 'Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ Ø²Ø§Ø¦Ø±';
      document.getElementById('auth-btn').textContent = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
      
      document.getElementById('login-section').classList.remove('hidden');
      document.getElementById('app-content').classList.add('hidden');
      
      // Reset form
      document.getElementById('login-form').reset();
      
      showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­');
    }

    // Products
    function loadProducts() {
      const grid = document.getElementById('products-grid');
      const searchTerm = document.getElementById('search-input').value.toLowerCase();
      const categoryFilter = document.getElementById('category-filter').value;
      
      let filteredProducts = products.filter(p => p.isActive);
      
      if (searchTerm) {
        filteredProducts = filteredProducts.filter(p => 
          p.name.toLowerCase().includes(searchTerm) || 
          p.description.toLowerCase().includes(searchTerm)
        );
      }
      
      if (categoryFilter !== 'all') {
        filteredProducts = filteredProducts.filter(p => p.category === categoryFilter);
      }
      
      if (filteredProducts.length === 0) {
        grid.innerHTML = `
          <div class="empty-state" style="grid-column: 1 / -1;">
            <div class="empty-state-icon">ğŸ›ï¸</div>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</h3>
            <p>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ù†ØªØ¬Ø§Øª ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ø¨Ø­Ø«</p>
          </div>
        `;
        return;
      }
      
      grid.innerHTML = filteredProducts.map(product => `
        <div class="product-card">
          <div class="product-image">
            ${product.imageUrl ? `<img src="${product.imageUrl}" alt="${product.name}">` : 'ğŸ“¦'}
          </div>
          <div class="product-info">
            <h3 class="product-name">${product.name}</h3>
            <p class="product-description">${product.description}</p>
            <div class="product-details">
              <span class="product-price">${formatPrice(product.priceIQD, product.priceUSD)}</span>
              <span class="product-stock">Ù…ØªÙˆÙØ±: ${product.stock}</span>
            </div>
            <button class="add-to-cart" onclick="addToCart(${product.id})" ${product.stock === 0 ? 'disabled' : ''}>
              ${product.stock === 0 ? 'Ù†ÙØ¯ Ø§Ù„Ù…Ø®Ø²ÙˆÙ†' : 'Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©'}
            </button>
          </div>
        </div>
      `).join('');
    }

    function loadCategories() {
      const categoryFilter = document.getElementById('category-filter');
      const productCategory = document.getElementById('product-category');
      
      const categoryOptions = categories
        .filter(c => c.isActive)
        .map(c => `<option value="${c.name}">${c.name}</option>`)
        .join('');
      
      categoryFilter.innerHTML = '<option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØ¦Ø§Øª</option>' + categoryOptions;
      if (productCategory) {
        productCategory.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø©</option>' + categoryOptions;
      }
    }

    // Cart
    function addToCart(productId) {
      const product = getProductById(productId);
      if (!product || product.stock === 0) {
        showToast('Ø§Ù„Ù…Ù†ØªØ¬ ØºÙŠØ± Ù…ØªÙˆÙØ±', 'error');
        return;
      }
      
      const existingItem = cart.find(item => item.productId === productId);
      
      if (existingItem) {
        if (existingItem.quantity < product.stock) {
          existingItem.quantity++;
          showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒÙ…ÙŠØ© ÙÙŠ Ø§Ù„Ø³Ù„Ø©');
        } else {
          showToast('Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©', 'error');
          return;
        }
      } else {
        cart.push({
          id: Date.now(),
          productId: productId,
          quantity: 1
        });
        showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©');
      }
      
      updateCartCount();
      if (document.getElementById('cart-tab').classList.contains('active')) {
        loadCart();
      }
    }

    function loadCart() {
      const cartItems = document.getElementById('cart-items');
      const cartTotal = document.getElementById('cart-total');
      const cartCurrency = document.getElementById('cart-currency').value;
      
      if (cart.length === 0) {
        cartItems.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">ğŸ›’</div>
            <h3>Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©</h3>
            <p>Ø£Ø¶Ù Ø¨Ø¹Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„ØªØ¨Ø¯Ø£ Ø§Ù„ØªØ³ÙˆÙ‚</p>
          </div>
        `;
        cartTotal.classList.add('hidden');
        return;
      }
      
      cartTotal.classList.remove('hidden');
      
      let totalIQD = 0;
      let totalUSD = 0;
      
      cartItems.innerHTML = cart.map(item => {
        const product = getProductById(item.productId);
        if (!product) return '';
        
        const itemTotalIQD = product.priceIQD * item.quantity;
        const itemTotalUSD = product.priceUSD * item.quantity;
        
        totalIQD += itemTotalIQD;
        totalUSD += itemTotalUSD;
        
        return `
          <div class="cart-item">
            <div class="cart-item-image">
              ${product.imageUrl ? `<img src="${product.imageUrl}" alt="${product.name}">` : 'ğŸ“¦'}
            </div>
            <div class="cart-item-info">
              <div class="cart-item-name">${product.name}</div>
              <div class="cart-item-description">${product.description}</div>
              <div class="cart-item-price">${formatPrice(product.priceIQD, product.priceUSD, cartCurrency)}</div>
            </div>
            <div class="quantity-controls">
              <button class="quantity-btn" onclick="updateCartQuantity(${item.id}, ${item.quantity - 1})">-</button>
              <span class="quantity-display">${item.quantity}</span>
              <button class="quantity-btn" onclick="updateCartQuantity(${item.id}, ${item.quantity + 1})">+</button>
            </div>
            <div class="cart-item-actions">
              <div class="cart-item-total">${formatPrice(itemTotalIQD, itemTotalUSD, cartCurrency)}</div>
              <button class="remove-item" onclick="removeFromCart(${item.id})">Ø­Ø°Ù</button>
            </div>
          </div>
        `;
      }).join('');
      
      document.getElementById('total-amount').textContent = formatPrice(totalIQD, totalUSD, cartCurrency);
    }

    function updateCartQuantity(itemId, newQuantity) {
      const item = cart.find(i => i.id === itemId);
      if (!item) return;
      
      const product = getProductById(item.productId);
      if (!product) return;
      
      if (newQuantity <= 0) {
        removeFromCart(itemId);
        return;
      }
      
      if (newQuantity > product.stock) {
        showToast('Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©', 'error');
        return;
      }
      
      item.quantity = newQuantity;
      updateCartCount();
      loadCart();
      showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙƒÙ…ÙŠØ©');
    }

    function removeFromCart(itemId) {
      cart = cart.filter(item => item.id !== itemId);
      updateCartCount();
      loadCart();
      showToast('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ù…Ù† Ø§Ù„Ø³Ù„Ø©');
    }

    function clearCart() {
      cart = [];
      updateCartCount();
      loadCart();
      showToast('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø³Ù„Ø©');
    }

    function checkout() {
      if (cart.length === 0) {
        showToast('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©', 'error');
        return;
      }
      
      const cartCurrency = document.getElementById('cart-currency').value;
      let totalIQD = 0;
      let totalUSD = 0;
      
      const orderItems = cart.map(item => {
        const product = getProductById(item.productId);
        const itemTotalIQD = product.priceIQD * item.quantity;
        const itemTotalUSD = product.priceUSD * item.quantity;
        
        totalIQD += itemTotalIQD;
        totalUSD += itemTotalUSD;
        
        // Update stock
        product.stock -= item.quantity;
        
        return {
          productId: item.productId,
          productName: product.name,
          quantity: item.quantity,
          priceIQD: product.priceIQD,
          priceUSD: product.priceUSD
        };
      });
      
      const order = {
        id: Date.now(),
        customerId: currentUser.id,
        customerName: currentUser.name,
        items: orderItems,
        totalIQD: totalIQD,
        totalUSD: totalUSD,
        currency: cartCurrency,
        status: 'pending',
        date: new Date().toISOString(),
        notes: ''
      };
      
      orders.push(order);
      cart = [];
      
      updateCartCount();
      loadCart();
      loadProducts(); // Refresh to show updated stock
      
      showToast('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
      
      // Switch to orders tab
      switchTab('orders');
    }

    // Profile
    function loadProfile() {
      if (!currentUser) return;
      
      document.getElementById('profile-name').value = currentUser.name;
      document.getElementById('profile-email').value = currentUser.email;
      document.getElementById('profile-phone').value = currentUser.phone;
      document.getElementById('profile-city').value = currentUser.city;
      document.getElementById('profile-address').value = currentUser.address;
      document.getElementById('profile-currency').value = currentUser.preferredCurrency;
    }

    function toggleEditProfile() {
      isEditingProfile = !isEditingProfile;
      
      const inputs = document.querySelectorAll('#profile-form input, #profile-form textarea, #profile-form select');
      const editBtn = document.getElementById('edit-profile');
      const saveBtn = document.getElementById('save-profile');
      
      inputs.forEach(input => {
        input.disabled = !isEditingProfile;
      });
      
      if (isEditingProfile) {
        editBtn.textContent = 'Ø¥Ù„ØºØ§Ø¡';
        saveBtn.classList.remove('hidden');
      } else {
        editBtn.textContent = 'ØªØ¹Ø¯ÙŠÙ„';
        saveBtn.classList.add('hidden');
        loadProfile(); // Reset form
      }
    }

    function saveProfile() {
      if (!currentUser) return;
      
      currentUser.name = document.getElementById('profile-name').value;
      currentUser.email = document.getElementById('profile-email').value;
      currentUser.phone = document.getElementById('profile-phone').value;
      currentUser.city = document.getElementById('profile-city').value;
      currentUser.address = document.getElementById('profile-address').value;
      currentUser.preferredCurrency = document.getElementById('profile-currency').value;
      
      currentCurrency = currentUser.preferredCurrency;
      
      document.getElementById('user-name').textContent = `Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${currentUser.name}`;
      
      toggleEditProfile();
      showToast('ØªÙ… Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª');
    }

    // Orders
    function loadOrders() {
      const ordersList = document.getElementById('orders-list');
      const userOrders = orders.filter(order => order.customerId === currentUser.id);
      
      if (userOrders.length === 0) {
        ordersList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">ğŸ“¦</div>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</h3>
            <p>Ù„Ù… ØªÙ‚Ù… Ø¨Ø£ÙŠ Ø·Ù„Ø¨Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>
          </div>
        `;
        return;
      }
      
      ordersList.innerHTML = userOrders.map(order => `
        <div class="order-card">
          <div class="order-header">
            <div class="order-info">
              <h3>Ø·Ù„Ø¨ #${order.id.toString().slice(-8)}</h3>
              <div class="order-date">${new Date(order.date).toLocaleDateString('ar-IQ')}</div>
            </div>
            <span class="order-status status-${order.status}">${getStatusText(order.status)}</span>
          </div>
          <div class="order-items">
            ${order.items.map(item => `
              <div class="order-item">
                <div>
                  <span>${item.productName}</span>
                  <span style="color: #64748b; margin-right: 0.5rem;">Ã— ${item.quantity}</span>
                </div>
                <span>${formatPrice(item.priceIQD * item.quantity, item.priceUSD * item.quantity, order.currency)}</span>
              </div>
            `).join('')}
          </div>
          <div class="order-total">
            <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
            <span>${formatPrice(order.totalIQD, order.totalUSD, order.currency)}</span>
          </div>
        </div>
      `).join('');
    }

    function getStatusText(status) {
      const statusMap = {
        'pending': 'ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
        'confirmed': 'Ù…Ø¤ÙƒØ¯',
        'shipped': 'ØªÙ… Ø§Ù„Ø´Ø­Ù†',
        'delivered': 'ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…',
        'cancelled': 'Ù…Ù„ØºÙŠ'
      };
      return statusMap[status] || status;
    }

    // Admin
    function loadAdminProducts() {
      const grid = document.getElementById('admin-products-grid');
      
      grid.innerHTML = products.map(product => `
        <div class="admin-card">
          <h4>${product.name}</h4>
          <p>${product.description}</p>
          <div style="font-size: 0.875rem; color: #64748b;">
            <p>Ø§Ù„Ø³Ø¹Ø±: ${product.priceIQD.toLocaleString()} Ø¯.Ø¹ / $${product.priceUSD}</p>
            <p>Ø§Ù„Ù…Ø®Ø²ÙˆÙ†: ${product.stock}</p>
            <p>Ø§Ù„ÙØ¦Ø©: ${product.category}</p>
          </div>
        </div>
      `).join('');
    }

    function loadAdminOrders() {
      const ordersList = document.getElementById('admin-orders-list');
      
      if (orders.length === 0) {
        ordersList.innerHTML = `
          <div class="empty-state">
            <div class="empty-state-icon">ğŸ“¦</div>
            <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª</h3>
            <p>Ù„Ù… ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø£ÙŠ Ø·Ù„Ø¨Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>
          </div>
        `;
        return;
      }
      
      ordersList.innerHTML = orders.map(order => `
        <div class="order-card">
          <div class="order-header">
            <div class="order-info">
              <h3>Ø·Ù„Ø¨ #${order.id.toString().slice(-8)}</h3>
              <div class="order-date">
                Ø§Ù„Ø¹Ù…ÙŠÙ„: ${order.customerName}<br>
                Ø§Ù„ØªØ§Ø±ÙŠØ®: ${new Date(order.date).toLocaleDateString('ar-IQ')}
              </div>
            </div>
            <select onchange="updateOrderStatus(${order.id}, this.value)" style="padding: 0.25rem; border: 1px solid #d1d5db; border-radius: 0.25rem;">
              <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
              <option value="confirmed" ${order.status === 'confirmed' ? 'selected' : ''}>Ù…Ø¤ÙƒØ¯</option>
              <option value="shipped" ${order.status === 'shipped' ? 'selected' : ''}>ØªÙ… Ø§Ù„Ø´Ø­Ù†</option>
              <option value="delivered" ${order.status === 'delivered' ? 'selected' : ''}>ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…</option>
              <option value="cancelled" ${order.status === 'cancelled' ? 'selected' : ''}>Ù…Ù„ØºÙŠ</option>
            </select>
          </div>
          <div class="order-items">
            ${order.items.map(item => `
              <div class="order-item">
                <span>${item.quantity}Ã— ${item.productName}</span>
              </div>
            `).join('')}
          </div>
          <div class="order-total">
            <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
            <span>${formatPrice(order.totalIQD, order.totalUSD, order.currency)}</span>
          </div>
        </div>
      `).join('');
    }

    function loadAdminCategories() {
      const grid = document.getElementById('admin-categories-grid');
      
      grid.innerHTML = categories.map(category => `
        <div class="admin-card">
          <h4>${category.name}</h4>
          ${category.description ? `<p>${category.description}</p>` : ''}
        </div>
      `).join('');
    }

    function updateOrderStatus(orderId, newStatus) {
      const order = orders.find(o => o.id === orderId);
      if (order) {
        order.status = newStatus;
        showToast('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨');
        
        // Refresh orders if user is viewing their orders
        if (document.getElementById('orders-tab').classList.contains('active')) {
          loadOrders();
        }
      }
    }

    function addProduct() {
      const name = document.getElementById('product-name').value;
      const description = document.getElementById('product-description').value;
      const priceIQD = parseFloat(document.getElementById('product-price-iqd').value);
      const priceUSD = parseFloat(document.getElementById('product-price-usd').value);
      const category = document.getElementById('product-category').value;
      const stock = parseInt(document.getElementById('product-stock').value);
      const imageUrl = document.getElementById('product-image').value;
      
      if (!name || !description || !priceIQD || !priceUSD || !category || !stock) {
        showToast('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©', 'error');
        return;
      }
      
      const newProduct = {
        id: Date.now(),
        name,
        description,
        priceIQD,
        priceUSD,
        category,
        stock,
        imageUrl: imageUrl || '',
        isActive: true
      };
      
      products.push(newProduct);
      
      // Reset form
      document.getElementById('product-form').reset();
      document.getElementById('add-product-form').classList.add('hidden');
      
      loadAdminProducts();
      loadProducts();
      loadCategories();
      
      showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
    }

    function addCategory() {
      const name = document.getElementById('category-name').value;
      const description = document.getElementById('category-description').value;
      
      if (!name) {
        showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„ÙØ¦Ø©', 'error');
        return;
      }
      
      const newCategory = {
        id: Date.now(),
        name,
        description: description || '',
        isActive: true
      };
      
      categories.push(newCategory);
      
      // Reset form
      document.getElementById('category-form').reset();
      document.getElementById('add-category-form').classList.add('hidden');
      
      loadAdminCategories();
      loadCategories();
      
      showToast('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ¦Ø© Ø¨Ù†Ø¬Ø§Ø­');
    }

    // Navigation
    function switchTab(tabName) {
      // Update nav tabs
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
      
      // Update tab content
      document.querySelectorAll('.tab-pane').forEach(pane => {
        pane.classList.remove('active');
      });
      document.getElementById(`${tabName}-tab`).classList.add('active');
      
      // Load content based on tab
      switch(tabName) {
        case 'products':
          loadProducts();
          break;
        case 'cart':
          loadCart();
          break;
        case 'profile':
          loadProfile();
          break;
        case 'orders':
          loadOrders();
          break;
        case 'admin':
          if (currentUser && currentUser.isAdmin) {
            loadAdminProducts();
            loadAdminOrders();
            loadAdminCategories();
          }
          break;
      }
    }

    function switchAdminSection(sectionName) {
      // Update admin nav
      document.querySelectorAll('.admin-nav-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      document.querySelector(`[data-section="${sectionName}"]`).classList.add('active');
      
      // Update admin content
      document.querySelectorAll('.admin-section').forEach(section => {
        section.classList.remove('active');
      });
      document.getElementById(`admin-${sectionName}`).classList.add('active');
    }

    // Event Listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Login form
      document.getElementById('login-form').addEventListener('submit', function(e) {
        e.preventDefault();
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        if (login(username, password)) {
          // Success handled in login function
        } else {
          showToast('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
        }
      });
      
      // Auth button
      document.getElementById('auth-btn').addEventListener('click', function() {
        if (currentUser) {
          logout();
        } else {
          // Already on login page
        }
      });
      
      // Navigation tabs
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.addEventListener('click', function() {
          const tabName = this.getAttribute('data-tab');
          
          // Hide admin tab for non-admin users
          if (tabName === 'admin' && (!currentUser || !currentUser.isAdmin)) {
            showToast('Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ ØµÙ„Ø§Ø­ÙŠØ© Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…', 'error');
            return;
          }
          
          switchTab(tabName);
        });
      });
      
      // Admin navigation
      document.querySelectorAll('.admin-nav-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          const sectionName = this.getAttribute('data-section');
          switchAdminSection(sectionName);
        });
      });
      
      // Search and filters
      document.getElementById('search-input').addEventListener('input', loadProducts);
      document.getElementById('category-filter').addEventListener('change', loadProducts);
      document.getElementById('currency-select').addEventListener('change', function() {
        currentCurrency = this.value;
        loadProducts();
      });
      
      // Cart currency
      document.getElementById('cart-currency').addEventListener('change', loadCart);
      
      // Cart actions
      document.getElementById('clear-cart').addEventListener('click', clearCart);
      document.getElementById('checkout-btn').addEventListener('click', checkout);
      
      // Profile
      document.getElementById('edit-profile').addEventListener('click', toggleEditProfile);
      document.getElementById('profile-form').addEventListener('submit', function(e) {
        e.preventDefault();
        saveProfile();
      });
      
      // Admin forms
      document.getElementById('show-add-product').addEventListener('click', function() {
        document.getElementById('add-product-form').classList.remove('hidden');
      });
      
      document.getElementById('cancel-add-product').addEventListener('click', function() {
        document.getElementById('add-product-form').classList.add('hidden');
        document.getElementById('product-form').reset();
      });
      
      document.getElementById('product-form').addEventListener('submit', function(e) {
        e.preventDefault();
        addProduct();
      });
      
      document.getElementById('show-add-category').addEventListener('click', function() {
        document.getElementById('add-category-form').classList.remove('hidden');
      });
      
      document.getElementById('cancel-add-category').addEventListener('click', function() {
        document.getElementById('add-category-form').classList.add('hidden');
        document.getElementById('category-form').reset();
      });
      
      document.getElementById('category-form').addEventListener('submit', function(e) {
        e.preventDefault();
        addCategory();
      });
      
      // Initialize
      loadCategories();
    });
  </script>
</body>
</html>
